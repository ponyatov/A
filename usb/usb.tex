\secrel{USB}\secdown

Многообразные порты, унаследованные от компьютеров IBM PC и PS/2, уходят в
прошлое. Будущее, да и настоящее, принадлежит универсальным скоростным портам
USB. Об удобствах, которые USB предоставляет простым пользователям,
распространяться не приходится. Единый интерфейс для всех устройств, обладающий
возможностями Plug’n’Play и продвинутого управления питанием\ --- именно то, что
нужно пользователям, для которых компьютер\ --- часть бытовой техники.
Другое дело\ --- индивидуальные разработчики различных устройств и просто
хакеры. Для этих категорий переход на USB представляет определенные сложности.
Проблема заключается в том, что USB\ --- интеллектуальный интерфейс.

Любое устройство, предназначенное для подключения к компьютеру через USB, должно
поддерживать хотя бы небольшую часть спецификации протокола USB: уметь
«представиться»\note{предоставить информацию о себе и своих возможностях} и
адекватно реагировать на стандартные сообщения USB, посылаемые компьютером. В
результате, даже устройство, все функции которого ограничиваются включением и
выключением светодиода по сигналу с компьютера, при подключении через USB
требует наличия микросхемы, которая умеет «разговаривать» с хостом.

Однако и для
разработчиков собственных устройств переход на USB несет определенные
преимущества. Прежде всего, упрощается процесс написания драйверов. Поскольку
для общения с компьютером все USB устройства используют единый протокол, причем
протокол этот абстрагирован от таких аппаратно-зависимых вещей как отображенные
в память порты и прерывания, возникает возможность не писать свой собственный
драйвер уровня ядра для каждого устройства. Вместо этого целые группы устройств
могут использовать один и тот же драйвер уровня ядра, а специфичный код,
учитывающий особенности конкретного устройства, может быть размещен на
пользовательском уровне. При этом драйвер уровня ядра берет на себя такие
функции как управление питанием устройства\note{весьма нетривиальная задача с
учетом того, что сам компьютер может переключаться между несколькими
энергосберегающими режимами}, оставляя нам самое интересное\ --- управление
функциями устройства.

Перенос кода управления устройством в \term{userspace} не только упрощает
отладку\note{при падении приложения, скорее всего, не придется перезагружать
машину}, но и позволят писать процедуры управления устройством на самых разных
языках программирования, а не только на Си, как это делают те, кто пишет
драйверы уровня ядра. Более того, пользовательская часть драйвера, не
взаимодействующая напрямую с механизмами ядра операционной системы, может быть
сделана кросс-платформенной, что мы и имеем в случае таких инструментов как
\prog{libusb}. Благодаря \prog{libusb} даже многие устройства промышленного
уровня могут обходиться без собственных драйверов на уровне ядра для каждой ОС,
и иметь одну кодовую базу, которую проще модифицировать и сопровождать.
Что уж говорить о любительских устройствах?

\input{usb/protocol}
\input{usb/libusb}
\input{usb/linux}

\secup
