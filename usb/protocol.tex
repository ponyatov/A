\secrel{Стек протоколов USB}

Протокол USB похож на стек сетевых протоколов, основанных на TCP/IP, точнее за
основу принималась сетевая модель стека сетевых протоколов OSI/ISO\note{ISO/IEC
7498-1, ГОСТ Р ИСО/МЭК 7498-1-99}:

\input{net/osi}

На самом нижнем логическом уровне\note{спецификации физического уровня мы пока
не рассматриваем} устройства обмениваются пакетами данных\note{со встроенными
механизмами коррекции ошибок, подтверждения получения и т.д}. Из пакетов
формируются запросы, которые устройства посылают друг другу. Запросы составляют
блоки запросов [U]SB [R]equest [B]lock, \termdef{URB}{USB!URB}.

Протокол USB является ``хостоцентричным"\ --- процесс передачи данных всегда
инициируется хостом (то есть, компьютером). Если у периферийного устройства
появились данные для передачи хосту, оно должно ожидать запроса хоста на
передачу данных. Соответственно мы имеем следующие типы USB устройтсв:

\begin{description}
  \item[host] \termdef{хост-контроллер}{USB!хост-контроллер} выполянет функции
  головного узла: инициирует передачу данных, управляет питанием
  \item[client] 
  \item[OTG] \termdef{[O]n-[T]he-[G]o}{USB!On-The-Go}, \termdef{OTG}{USB!OTG}\
  --- расширение спецификации USB 2.0, предназначенное для лёгкого соединения
  периферийных USB-устройств друг с другом без необходимости подключения к
  хосту. Например, цифровой фотоаппарат можно подключать к фотопринтеру
  напрямую, если они оба поддерживают стандарт USB OTG. К моделям КПК и
  коммуникаторов, поддерживающих USB OTG, можно подключать некоторые
  USB-устройства. Обычно это флэш-накопители, цифровые фотоаппараты, клавиатуры,
  мыши и другие устройства, не требующие дополнительных драйверов.
  При подключении через USB OTG ранг устройства (ведущий или ведомый)
  определяется наличием или, соответственно, отсутствием перемычки между
  контактами 4 (ID) и 5 (Ground) в штекере соединительного кабеля. В USB OTG
  кабеле такая перемычка устанавливается лишь в одном из двух разъёмов.
\end{description}
